<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Artists Finder</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/scroll-carousel@1.2.7/dist/scroll.carousel.min.css">
  <style>
    .scrollable-container {
      max-width: auto;
      max-height: 600px;
      overflow-y: auto;
      opacity: 0.9;
    }

    .dark-form .form-control {
      background-color: #333;
      border-color: #444;
      /* Darker border for inputs */
      color: #fff;
      /* Light text */
    }

    .dark-form label {
      color: #fff;
      /* Light text for labels */
    }

    .dark-form {
      /* background-color: #555; */
      padding: 20px;
      color: #fff;
      border-radius: 8px;
    }
  </style>
</head>

<body>
  <br>
  <br>
  <br>
  <br>
  <div class="d-flex justify-content-center align-items-center vh-75">
  </div>
  <main class="container mt-5">
    <h1 *ngIf="!selected" class="text-center mb-4">My Artists</h1>
    <div *ngIf="!loggedIn()" class="row">
      <app-login></app-login>
    </div>
    <div clas="row">
      <div class="col">
        <div class="mb-3">
          <div *ngIf="loggedIn()" class="row">
            <br>
            <br>
            <label name="addArtist">Add a new artist</label>
            <form class="addArtistForm">
              <input class="form-control" type="text" name="name" [(ngModel)]="newArtist.name" required
                placeholder="artist name">
              <!-- <input class="form-control" type="text" name="band" [(ngModel)]="newArtist.band"
                placeholder="artist band"> -->
              <button class="btn btn-primary" (click)="addArtist(newArtist)">Add new Arist</button>
            </form>
            <div *ngIf="! selected">
              <div class="text-center mb-4 scrollable-container">
                <table class="table table-striped table-hover table-dark">
                  <thead class="table-dark">
                    <th>ID</th>
                    <th>Name</th>
                    <th>Artist Info</th>
                    <th>Delete Artist</th>
                  </thead>
                  <tbody>
                    <tr *ngFor="let a of artists">
                      <td (click)="displayArtists(a);searchArtist(a.name)">{{a.id}}</td>
                      <td (click)="displayArtists(a);searchArtist(a.name)">{{a.name}}</td>
                      <td> <button class="btn btn-primary" (click)="displayArtists(a);searchArtist(a.name)">+</button>
                      </td>
                      <td> <button class="btn btn-danger" (click)="deleteArtist(a.id)">X</button> </td>
                    </tr>
                  </tbody>
                </table>
                <br><br>
              </div>
            </div>

            <div class="mb-3 text-center" id="artistData" *ngIf="selected">
              <br><br>
              <h1>{{selected.name}}</h1>
              <br>
              <div class="song-detail">
                <img [src]="songDetail.images[0].url" [alt]="songDetail.name" style="width:700px;height:650px;">
                <h4>Spotify Followers: {{songDetail.followers.total}}</h4>
                <h4>Genre: {{songDetail.genres[2]}}</h4>
                <h4><a [href]="songDetail.external_urls.spotify" target="_blank">See on Spotify</a></h4>
              </div>
              <br>
              <div *ngIf="songs && songs.length > 0">
                <br><br>
                <h3 *ngFor="let song of songs">{{ song.name }}, {{ song.year }} {{ song.album }} {{ song.genre }}
                  <button class="btn btn-primary" (click)="searchTrack(song.name, selected.name)">Details</button>
                  <button class="btn btn-danger" (click)="removeSongFromArtist(selected.id, song.id)">Delete</button>
                  <div *ngIf="trackDetail && selectedSong === song.name">
                    <div class="track-detail">
                      <img [src]="trackDetail.album.images[0].url" [alt]="trackDetail.name"
                        style="width:700px;height:650px;">
                      <div>Song: {{trackDetail.name}}</div>
                      <div>Artists: {{trackDetail.artists[0].name}}</div>
                      <div>{{trackDetail.album.type}}: {{trackDetail.album.name}} </div>
                      <div>Release Date: {{trackDetail.album.release_date}}</div>
                      <div>Popularity: {{trackDetail.popularity}}</div>
                      <div><audio [src]="trackDetail.preview_url" controls target="_blank">Preview Song</audio></div>
                      <div><a [href]="trackDetail.external_urls.spotify" target="_blank">Play on Spotify</a></div>
                    </div>
                  </div>
                </h3>
              </div>
              <br><br>
              <h4>{{selected.band}}</h4>
              <button class="btn btn-primary" (click)="getArtistSongs(selected.id)">GET SONGS - REFRESH</button>
              <!-- <button class="btn btn-primary" (click)="editArtistToggle()">Update This Artist</button> -->
              <button class="btn btn-primary" (click)="newSongToggle()">Add New Song</button>
              <!-- <button class="btn btn-primary" (click)="editSongToggle()">Update A Song</button> -->
              <button class="btn btn-danger" (click)="displayTable();resetTable();resetSong()">Back</button>
              <br><br>
            </div>
          </div>
          <div class="searchbar mb-3" *ngIf="editArtistSelected && selected">
            <form class=".form-control artistsEditForm">
              <input class="form-control" type="text" name="name" [(ngModel)]="editArtist.name"
                placeholder="Updated Name">
              <!-- <input class="form-control" type="text" name="name" [(ngModel)]="editArtist.band"
                placeholder="Updated Band"> -->
              <button class="btn btn-primary" (click)="updateArtist(editArtist);editArtistToggle()">Save</button>
              <button class="btn btn-danger" (click)="editArtist = null">Cancel</button>
            </form>
          </div>
        </div>
        <div>
          <div class="searchbar mb-3" *ngIf="newSongSelected && selected">
            <label name="add Song">Add song to this artist</label>
            <input class="form-control" type="text" name="song" [(ngModel)]="newSong.name" placeholder="New Song Name">
            <!-- <input class="form-control" type="text" name="album" [(ngModel)]="newSong.album"
              placeholder="New Album">
            <input class="form-control" type="number" name="year" [(ngModel)]="newSong.year" placeholder=2024>
            <input class="form-control" type="text" name="genre" [(ngModel)]="newSong.genre"
              placeholder="New Genre"> -->
            <div class="d-flex justify-content-center align-items-center">
              <button class="btn btn-primary"
                (click)="addSongToArtist(selected.id, newSong);newSongToggle();getArtistSongs(selected.id)">Add
                Song</button>
            </div>
          </div>
        </div>
        <div>
          <div class="searchbar mb-3" *ngIf="editSongSelected && selected">
            <label name="add Song">Update a Song</label>
            <input class="form-control" type="text" name="name" [(ngModel)]="editSong.name"
              placeholder="Updated Song Name">
            <!-- <input class="form-control" type="text" name="album" [(ngModel)]="editSong.album" placeholder="Updated Album">
            <input class="form-control" type="number" name="year" [(ngModel)]="editSong.year" placeholder=2024>
            <input class="form-control" type="text" name="genre" [(ngModel)]="editSong.genre" placeholder="Updated Genre"> -->
            <div class="d-flex justify-content-center align-items-center">
              <button class="btn btn-primary"
                (click)="addSongToArtist(selected.id, editSong);editSongToggle();getArtistSongs(selected.id)">Update
                Song</button>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-center align-items-center vh-100">
        </div>
        <p>Background image: "Vinyl Records" by Clay Banks, hosted on Canva. Used under license/agreement. All rights
          reserved.</p>
      </div>
    </div>

  </main>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <!-- JavaScript dependencies  -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
  <script src="app.js" type="text/javascript"></script>
  <script src="js/script.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/scroll-carousel@1.2.7/dist/scroll.carousel.min.js"></script>



</body>

</html>
